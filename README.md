## Codes for Figures 3 to 7 in Liu et al. 2024

### Environments: 

- analysis2 environment: Figure3_Figure4.ipynb, Figure7_preparation.ipynb

- analysis environment: Figures5-7.ipynb


### Figure3_Figure4.ipynb

1. Open notebook
2. Change `working_directory= ` path  
    > This directory should contain folders Horizontal_Axon, ARA_25_micron_mhd_ccf2017, and files injection_sites_results_expanded.xlsx, s1_sample_info.xlsx and s2_sample_info.xlsx
3. Run section-  Figure 3  
    > Change `region = ` 's1' or 's2' in the first cell under Figure 3 and re-run section Figure 3
4. Run section- Figure 4
5. Run section- Preparation categorical data as excel files for Figures 5, 6 and 7  
    > Change `region = ` 's1' or 's2' in the second cell under this section and re-run section  

### Figure7_preparation.ipynb
1. Open notebook
2. Change `working_directory= ` path  
    > This directory should contain folders Horizontal_Axon, ARA_25_micron_mhd_ccf2017, and files injection_sites_results_expanded.xlsx, s1_sample_info.xlsx and s2_sample_info.xlsx
3. run the note book
4. go back to cell [41]
    > Change `site = ` 's1' or 's2' and re- run the notebook

### Figures5-7.ipynb
1. Open notebook
2. Change `working_directory= ` path  
    > This directory should contain folders Horizontal_Axon, ARA_25_micron_mhd_ccf2017, and files injection_sites_results_expanded.xlsx, s1_sample_info.xlsx and s2_sample_info.xlsx
3. Run the first 4 cells under section- Figure 5
    > Change `region = ` 's1' or 's2' in the second cell for this section and the first 4 cells under Figure 5
4. Run the rest of the section- Figure 5
    > change `region = ` 's1' or 's2' in cell [42] and re-run the subsequent cells in Figure 5
6. Run all cells under section- Figure 6
7. Run all cells under section- Figure 7

### Figure1sup4.ipynb
1. Open notebook
2. Change `working_directory= ` path
   > This directory should contain folders Horizontal_Axon, ARA_25_micron_mhd_ccf2017, and files injection_sites_results_expanded.xlsx, s1_sample_info.xlsx and s2_sample_info.xlsx
3. Run all cells

### Figure5sup3.ipynb
1. Open notebook
2. Change `working_directory= ` path
   > This directory should contain folders Horizontal_Axon, ARA_25_micron_mhd_ccf2017, and files injection_sites_results_expanded.xlsx, s1_sample_info.xlsx and s2_sample_info.xlsx
3. Run all code once, then re-run section - Number of isocortex innervated after changing region='s1' to region= 's2'

### Figure7sup1.ipynb
1. Open notebook
2. Change `working_directory= ` path
   > This directory should contain folders Horizontal_Axon, ARA_25_micron_mhd_ccf2017, and files injection_sites_results_expanded.xlsx, s1_sample_info.xlsx and s2_sample_info.xlsx
3. Run all cells
